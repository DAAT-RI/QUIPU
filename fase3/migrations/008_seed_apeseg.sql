-- =====================================================
-- FASE 3: Seed Cliente Demo - APESEG
-- Generado automáticamente desde CANDIDATOS_JNE_2026_APESEG.csv
-- Total DNIs: 162
-- =====================================================

-- 1. Crear cliente APESEG
INSERT INTO quipu_clientes (nombre, tipo, sector, plan, max_candidatos, contacto_email)
VALUES ('APESEG', 'gremio', 'seguros', 'enterprise', 200, 'demo@apeseg.com.pe')
ON CONFLICT DO NOTHING;

-- 2. Asignar candidatos al cliente
-- Nota: Si hay duplicados de DNI, preferir PRESIDENTE > VICEPRESIDENTE > otros
INSERT INTO quipu_cliente_candidatos (cliente_id, candidato_id)
SELECT
    (SELECT id FROM quipu_clientes WHERE nombre = 'APESEG'),
    candidato_id
FROM (
    SELECT DISTINCT ON (c.dni)
        c.id as candidato_id,
        c.dni
    FROM quipu_candidatos c
    WHERE c.dni IN (
        '00076154','01157063','01211014','01295689','01311614','02417724','02794608','04411300','04415907','06002034','06280714','06282599','06303156','06354697','06449530','06466585','06506278','06529088','06652331','06654879','06656534','06981876','07210262','07214151','07240324','07246887','07250032','07260881','07412350','07641046','07704730','07831436','07845838','07867789','07881480','07930633','07960843','07964787','08058852','08199906','08235876','08255194','08263758','08274679','08571708','08587486','08726151','08911520','09145206','09153143','09174186','09177250','09307547','09376064','09392269','09537000','09552537','09673565','09817415','09871134','09925246','10001088','10058209','10063223','10129700','10219647','10266270','10273657','10307948','10446596','10691398','10762763','10783805','10792277','10804834','10806296','15355636','15987710','16002918','16423581','16429203','16448148','16484970','16655831','16757459','16787889','16794778','17903382','17910128','18010708','18113682','18141156','18870364','19805447','19882183','21453924','21456255','21487528','21871411','23272702','23889981','23901989','25331980','25567150','25681995','25700579','25799622','25839717','26614247','27409088','28711059','29311203','29520242','29567624','29632775','29656225','29668031','32304953','40042080','40077944','40139245','40411110','40433187','40676234','40728264','40767221','40799023','41116948','41121519','41160918','41265978','41373494','41904418','41919665','42006704','42134579','42699423','42750152','43108553','43287528','43341622','43409673','43459367','43592504','43632186','43879107','44078565','44649199','44806029','45209282','45591954','45721573','49017178','70189958','70484086','71784531','72200895','80053194','80143959','80387180','80518613','80523585'
    )
    ORDER BY c.dni,
        CASE
            WHEN c.cargo_postula ILIKE '%PRESIDENTE DE LA%' THEN 1
            WHEN c.cargo_postula ILIKE '%VICEPRESIDENTE%' THEN 2
            WHEN c.cargo_postula ILIKE '%SENADOR%' THEN 3
            WHEN c.cargo_postula ILIKE '%DIPUTADO%' THEN 4
            ELSE 5
        END
) AS candidatos_unicos
ON CONFLICT DO NOTHING;

-- 3. Verificar cuántos candidatos se asignaron
-- SELECT COUNT(*) as candidatos_asignados
-- FROM quipu_cliente_candidatos
-- WHERE cliente_id = (SELECT id FROM quipu_clientes WHERE nombre = 'APESEG');
